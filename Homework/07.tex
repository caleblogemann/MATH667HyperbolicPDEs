\documentclass[11pt, oneside]{article}
\usepackage[letterpaper, margin=2cm]{geometry}
\usepackage{MATH667}
\usepackage{booktabs}

\begin{document}
\noindent \textbf{\Large{Caleb Logemann \\
MATH667 Hyperbolic Partial Differential Equations \\
Homework 7
}}

%\lstinputlisting[language=MATLAB]{H01_23.m}
\begin{enumerate}
    \item % #1
      Derive the following 3\textsuperscript{rd} order accuracy reconstruction
      for finite volume methods.
      \begin{align*}
        u_{j+1/2}^- &= -\frac{1}{6} \bar{u}_{j-1} + \frac{5}{6}\bar{u}_j + \frac{1}{3}\bar{u}_{j+1} \\
        u_{j+1/2}^+ &= \frac{1}{3} \bar{u}_{j} + \frac{5}{6}\bar{u}_{j+1} - \frac{1}{6}\bar{u}_{j+2}
      \end{align*}

      For this problem we would like to construct a quadractic polynomial $p(x)$
      such that $p$ matches the cell average on intervals $I_{j-1}$, $I_j$, and
      $I_{j+1}$.
      This means that we need to set $p(x) = ax^2 + bx + c$ and solve the following set
      of equations for $a$, $b$, and $c$.
      \begin{align*}
        \frac{1}{h} \dintt{x_{j-3/2}}{x_{j-1/2}}{p(x)}{x} &= \bar{u}_{j-1} \\
        \frac{1}{h} \dintt{x_{j-1/2}}{x_{j+1/2}}{p(x)}{x} &= \bar{u}_{j} \\
        \frac{1}{h} \dintt{x_{j+1/2}}{x_{j+3/2}}{p(x)}{x} &= \bar{u}_{j+1}
      \end{align*}
      These equation can be simplified as follows.
      \begin{align*}
        \frac{1}{3h}a \p{x_{j-1/2}^3 - x_{j-3/2}^3} + \frac{1}{2h}b\p{x_{j-1/2}^2 - x_{j-3/2}^2} + c &= \bar{u}_{j-1} \\
        \frac{1}{3h}a \p{x_{j+1/2}^3 - x_{j-1/2}^3} + \frac{1}{2h}b\p{x_{j+1/2}^2 - x_{j-1/2}^2} + c &= \bar{u}_{j} \\
        \frac{1}{3h}a \p{x_{j+3/2}^3 - x_{j+1/2}^3} + \frac{1}{2h}b\p{x_{j+3/2}^2 - x_{j+1/2}^2} + c &= \bar{u}_{j+1}
      \end{align*}
      Factoring the difference of cubes and difference of squares and cancelling
      $h$ gives
      \begin{align*}
        \frac{1}{3}a \p{x_{j-1/2}^2 + x_{j-1/2}x_{j-3/2} +  x_{j-3/2}^2} + \frac{1}{2}b\p{x_{j-1/2} + x_{j-3/2}} + c &= \bar{u}_{j-1} \\
        \frac{1}{3}a \p{x_{j+1/2}^2 + x_{j+1/2}x_{j-1/2} +  x_{j-1/2}^2} + \frac{1}{2}b\p{x_{j+1/2} + x_{j-1/2}} + c &= \bar{u}_{j} \\
        \frac{1}{3}a \p{x_{j+3/2}^2 + x_{j+3/2}x_{j+1/2} +  x_{j+1/2}^2} + \frac{1}{2}b\p{x_{j+3/2} + x_{j+1/2}} + c &= \bar{u}_{j+1}.
      \end{align*}
      Now I will substitute in so that all the x values are in terms of
      $x_{j+1/2}$ and $h$, i.e. $x_{j-3/2} = x_{j+1/2} - 2h$,
      $x_{j-1/2} = x_{j+1/2} - h$, etc.
      \begin{align*}
        \frac{1}{3}a \p{\p{x_{j+1/2} - h}^2 + \p{x_{j+1/2} - h}\p{x_{j+1/2} - 2h} +  \p{x_{j+1/2} - 2h}^2} + b\p{x_{j+1/2} - \frac{3}{2}h} + c &= \bar{u}_{j-1} \\
        \frac{1}{3}a \p{x_{j+1/2}^2 + x_{j+1/2}\p{x_{j+1/2} - h} +  \p{x_{j+1/2} - h}^2} + b\p{x_{j+1/2} - \frac{1}{2}h} + c &= \bar{u}_{j} \\
        \frac{1}{3}a \p{\p{x_{j+1/2} + h}^2 + \p{x_{j+1/2} + h}x_{j+1/2} +  x_{j+1/2}^2} + b\p{x_{j+1/2} + \frac{1}{2}h} + c &= \bar{u}_{j+1}.
      \end{align*}
      Simplifying gives
      \begin{align*}
        \frac{1}{3}a \p{3x_{j+1/2}^2 - 9hx_{j+1/2} + 7h^2} + b\p{x_{j+1/2} - \frac{3}{2}h} + c &= \bar{u}_{j-1} \\
        \frac{1}{3}a \p{3x_{j+1/2}^2 - 3hx_{j+1/2} + 1h^2} + b\p{x_{j+1/2} - \frac{1}{2}h} + c &= \bar{u}_{j} \\
        \frac{1}{3}a \p{3x_{j+1/2}^2 + 3hx_{j+1/2} + 1h^2} + b\p{x_{j+1/2} + \frac{1}{2}h} + c &= \bar{u}_{j+1}.
      \end{align*}
      Subtracting the last two equations gives
      \[
        2hx_{j+1/2}a - hb = \bar{u}_j - \bar{u}_{j+1}.
      \]
      Solving 



    \item % #2
    \item % #3

\end{enumerate}
\end{document}
